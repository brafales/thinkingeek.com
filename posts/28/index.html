<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
  
  <title>Think In Geek</title>
  <meta name="description" content="In geek we trust">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://thinkingeek.com/posts/28/">
  
  
  <link rel="alternate" type="application/rss+xml" title="Think In Geek" href="https://thinkingeek.com/feed.xml">

  

  
  <meta property="og:title" content="Think In Geek">
  <meta property="og:site_name" content="Think In Geek">
  <meta property="og:url" content="https://thinkingeek.com/posts/28/">
  <meta property="og:description" content="In geek we trust">
  
  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="Think In Geek">
  <meta name="twitter:description" content="In geek we trust">
  
  

  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
<link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700" rel="stylesheet">

  

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

      <span class="site-title"><a href="/">Think In Geek</a> | </span>
      <span class="site-slogan">In geek we trust</span>

    <nav class="site-nav"><a class="page-link" href="/arm-assembler-raspberry-pi/">Arm Assembler Raspberry Pi</a><a class="page-link" href="/gcc-tiny/">GCC tiny</a><a class="page-link" href="/author/brafales/">Posts by Bernat Ràfales</a><a class="page-link" href="/archives/">Archives</a></nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="home">

  <ul class="post-list"><li>
        <header class="post-header">
          <h1 class="post-title"><a class="post-link" href="/2009/10/12/c-the-and-operators-and-lazy-evaluation/">C#, the &quot;and&quot; operators and lazy evaluation</a></h1>

          <p class="post-meta">
            Oct 12, 2009• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Bernat Ràfales</span></span> • <a href="/categories/uncategorized/">Uncategorized</a> • <a href="/tags/c/">c#</a>, <a href="/tags/programming-tips/">programming tips</a></p>
        </header>

        <div class="post-content">
          <p>Today at work we found a bug. My workmate, not used to C#, usually uses the <i>&amp;</i> operator to compare boolean values. However, in C#, the <i>&amp;</i> operator does not use <a href="http://en.wikipedia.org/wiki/Lazy_evaluation">lazy evaluation</a>.</p>
<p>One curious thing about C# is that it can use two different operators to calculate an <i>and</i> expression: the <a href="http://msdn.microsoft.com/en-us/library/sbf85k1c.aspx">&amp;</a> operator and the <a href="http://msdn.microsoft.com/en-us/library/2a723cdk.aspx">&amp;&amp;</a> operator. The difference between both is that the first one (<i>&amp;</i>) can be used both with integer types and boolean types. When used with integer types it will perform a bitwise comparison between the two, and when used with boolean values it will use the logical <i>and</i> operation between the two boolean values, <b>evaluating all the parts of the expression</b>. This means that using a code like this one:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">if</span> <span class="p">(</span><span class="n">someObject</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;</span> <span class="n">someObject</span><span class="p">.</span><span class="n">SomeProperty</span> <span class="p">==</span> <span class="n">someValue</span><span class="p">)</span></code></pre></figure>

<p>will throw a runtime error if <i>someObject</i> is null, because it will try to obtain the <i>SomeProperty</i> value.</p>
<p>However, the <i>&amp;&amp;</i> operator is only available to boolean expressions, and it uses lazy evaluation, this is, if the first condition evaluated is false, it will calculate false without evaluating the rest of the expression, because an <i>and</i> is only true if all the expressions are true.</p>
<p>Conclusion, be sure to always use <i>&amp;&amp;</i> when evaluating boolean values if you want to avoid run time surprises :).
</p>

        </div></li><li>
        <header class="post-header">
          <h1 class="post-title"><a class="post-link" href="/2009/07/09/creating-and-testing-a-linked-list-based-queue-in-c-using-nunit/">Creating and testing a Linked List based Queue in C# using Nunit</a></h1>

          <p class="post-meta">
            Jul 9, 2009• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Bernat Ràfales</span></span> • <a href="/categories/uncategorized/">Uncategorized</a> • <a href="/tags/c/">c#</a>, <a href="/tags/nunit/">nunit</a>, <a href="/tags/unit-testing/">unit testing</a></p>
        </header>

        <div class="post-content">
          <p>The <a href="http://msdn.microsoft.com/en-us/library/7977ey2c.aspx">Queue&lt;T&gt;</a> class (and <a href="http://msdn.microsoft.com/en-us/library/3278tedw.aspx">Stack&lt;T&gt;</a> too) of the .NET Framework from Microsoft is implemented using an array. While this is a perfectly good approach, I think that a <a href="http://en.wikipedia.org/wiki/Linked_list">Linked List</a> based implementation could be desired in some situations (specifically when the size of the queue is not fixed).</p>

<p>Since the implementation alone would be rather simple for a post, I’ll show you how to implement <a href="http://en.wikipedia.org/wiki/Unit_testing">Unit Testing</a> with the class using <a href="http://www.nunit.org/">Nunit</a>. Although this is a rather simple class to test I think it will show the basic concepts behind unit testing.</p>

        </div><p class="post-continue">
            <a href="/2009/07/09/creating-and-testing-a-linked-list-based-queue-in-c-using-nunit/">Read on &rarr;</a>
          </p></li><li>
        <header class="post-header">
          <h1 class="post-title"><a class="post-link" href="/2009/06/08/disabling-updatepanels-when-an-asynchronous-postback-is-done/">Disabling UpdatePanels when an asynchronous postback in progress</a></h1>

          <p class="post-meta">
            Jun 8, 2009• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Bernat Ràfales</span></span> • <a href="/categories/uncategorized/">Uncategorized</a> • <a href="/tags/ajax/">ajax</a>, <a href="/tags/asp/">asp</a>, <a href="/tags/javascript/">javascript</a>, <a href="/tags/jquery/">jquery</a></p>
        </header>

        <div class="post-content">
          <p>If you’ve ever worked with relatively large UpdatePanels maybe you’ll have had a problem: blocking the user some elements while the asynchronous postback is running. When working with local or LAN environments, the async responses might be fast, but over the internet, or on large calculations the async postback may take a while. During this period, you may want to block the UpdatePanel controls so the user can’t trigger another postback or do any other operations on that UpdatePanel. I’ll show you an easy way to do so by using the AJAX framework for .NET and <a href="http://jquery.com">jQuery</a> and one of its plugins: <a href="http://malsup.com/jquery/block/">blockUI</a>.</p>

<p>For those who don’t know jQuery, it’s an opensource Javascript framework that <a href="http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx">is going to be embedded on future versions of Visual Studio</a>. It’s a very good framework because of its simplicity and its extensibility, having lots of plugins. One of those plugins is the blockUI plugin, which allows you to block and unlock any part of the DOM at will.</p>


        </div><p class="post-continue">
            <a href="/2009/06/08/disabling-updatepanels-when-an-asynchronous-postback-is-done/">Read on &rarr;</a>
          </p></li><li>
        <header class="post-header">
          <h1 class="post-title"><a class="post-link" href="/2009/03/11/using-ironpython-to-extend-your-net-applications/">Using IronPython to extend your .NET applications</a></h1>

          <p class="post-meta">
            Mar 11, 2009• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Bernat Ràfales</span></span> • <a href="/categories/uncategorized/">Uncategorized</a> • <a href="/tags/net/">.net</a>, <a href="/tags/c/">c#</a>, <a href="/tags/ironpython/">ironpython</a>, <a href="/tags/ironruby/">ironruby</a>, <a href="/tags/python/">python</a>, <a href="/tags/ruby/">ruby</a></p>
        </header>

        <div class="post-content">
          <p>
One of the interesting new things on the .NET platform is the recent addition of <a href="http://www.python.org/">Python</a> and <a href="http://ruby-lang.org/">Ruby</a> to the CLR. Both versions for .NET are called <a href="http://www.codeplex.com/IronPython">IronPython</a> and <a href="http://www.ironruby.net/">IronRuby</a> respectively, and they provide some new and good things to the platform.
</p>
<p>
Python and Ruby lovers will see now that they can use all the library and features of the .NET platform programming in their favorite scripting language. Since both of them are object oriented, you can now write fully fledged apps using either of them.
</p>
<p>
However, there's another interesting application for IronPython and IronRuby: adding scripting support for your existing .NET applications. This can be a very useful and powerful way to extend your applications and give the user freedom to program their own mini programs, scripts or whatever in your applications. It could be good for defining rules, assigning and calculating values, etc.
</p>
<p>
I'll provide a simple class you can use to add scripting to your application. I'll use IronPython in this example.
</p>
<p>
First of all, you have to download IronPython and install it, and add the references to the assemblies on your project references.
</p>
<p>
The usual way to proceed in those cases is to provide the user of some local variables you give them access to, execute the script, and then recover the values of those or new variables. To do so, You can use a class similar to this one:
</p>
<p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">IronPython.Hosting</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.Scripting.Hosting</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.Scripting</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Scripting</span>
<span class="p">{</span>
	<span class="k">internal</span> <span class="k">class</span> <span class="nc">PythonEngine</span>
	<span class="p">{</span>
        <span class="n">ScriptEngine</span> <span class="n">m_engine</span><span class="p">;</span>
        <span class="n">ExceptionOperations</span> <span class="n">m_exceptionOperations</span><span class="p">;</span>
        <span class="n">SortedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">m_inputVariables</span><span class="p">;</span>
        <span class="kt">string</span> <span class="n">m_script</span><span class="p">;</span>

        <span class="k">internal</span> <span class="nf">PythonEngine</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">m_engine</span> <span class="p">=</span> <span class="n">Python</span><span class="p">.</span><span class="nf">CreateEngine</span><span class="p">();</span>
            <span class="n">m_exceptionOperations</span> <span class="p">=</span> <span class="n">m_engine</span><span class="p">.</span><span class="n">GetService</span><span class="p">&lt;</span><span class="n">ExceptionOperations</span><span class="p">&gt;();</span>
        <span class="p">}</span>

        <span class="k">internal</span> <span class="n">SortedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">ScriptVariables</span>
        <span class="p">{</span>
            <span class="k">set</span> <span class="p">{</span> <span class="n">m_inputVariables</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">internal</span> <span class="kt">string</span> <span class="n">Script</span>
        <span class="p">{</span>
            <span class="k">set</span> <span class="p">{</span> <span class="n">m_script</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">internal</span> <span class="n">ExceptionOperations</span> <span class="n">ExceptionOperations</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_exceptionOperations</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">internal</span> <span class="n">SortedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="nf">Execute</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">//Create structures</span>
            <span class="n">SourceCodeKind</span> <span class="n">sc</span> <span class="p">=</span> <span class="n">SourceCodeKind</span><span class="p">.</span><span class="n">Statements</span><span class="p">;</span>
            <span class="n">ScriptSource</span> <span class="n">source</span> <span class="p">=</span> <span class="n">m_engine</span><span class="p">.</span><span class="nf">CreateScriptSourceFromString</span><span class="p">(</span><span class="n">m_script</span><span class="p">,</span> <span class="n">sc</span><span class="p">);</span>
            <span class="n">ScriptScope</span> <span class="n">scope</span> <span class="p">=</span> <span class="n">m_engine</span><span class="p">.</span><span class="nf">CreateScope</span><span class="p">();</span>
            <span class="c1">//Fill input variables</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="n">KeyValuePair</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">variable</span> <span class="k">in</span> <span class="n">m_inputVariables</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">scope</span><span class="p">.</span><span class="nf">SetVariable</span><span class="p">(</span><span class="n">variable</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span> <span class="n">variable</span><span class="p">.</span><span class="n">Value</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">SortedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">outputVariables</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SortedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;();</span>
            <span class="c1">//Execute the script</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="n">source</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="n">scope</span><span class="p">);</span>
                <span class="c1">//Recover variables</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="kt">string</span> <span class="n">variable</span> <span class="k">in</span> <span class="n">scope</span><span class="p">.</span><span class="nf">GetVariableNames</span><span class="p">())</span>
                <span class="p">{</span>
                    <span class="n">outputVariables</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">scope</span><span class="p">.</span><span class="nf">GetVariable</span><span class="p">(</span><span class="n">variable</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">string</span> <span class="n">error</span> <span class="p">=</span> <span class="n">m_exceptionOperations</span><span class="p">.</span><span class="nf">FormatException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
                <span class="c1">//Do something with the pretty printed error</span>
                <span class="k">throw</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">outputVariables</span><span class="p">;</span>
        <span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

</p>
<p>
Usage of this class is pretty simple. You have to provide the object the script you want to execute and the input variables the script will have available as local variables. Once this is done, you have to call the Execute method, and this method will either return the output variables of the execution of the resulting script, or throw an exception.
</p>

        </div></li><li>
        <header class="post-header">
          <h1 class="post-title"><a class="post-link" href="/2008/11/18/full-view-of-combobox-drop-down-list-components-in-c-30/">Full view of ComboBox drop-down list components in C# 3.0</a></h1>

          <p class="post-meta">
            Nov 18, 2008• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Aleix López</span></span> • <a href="/categories/uncategorized/">Uncategorized</a> • <a href="/tags/net/">.net</a>, <a href="/tags/c/">c#</a>, <a href="/tags/programming-tips/">programming tips</a></p>
        </header>

        <div class="post-content">
          <p>By default in C# 3.0 ComboBox controls don’t provide support for showing drop-down list items if they exceed the width of their parent ComboBox, like this one:
</p>
<p><a href="/wp-content/uploads/2008/11/image001.png"><img src="/wp-content/uploads/2008/11/image001.png" alt="Cropped ComboBox" title="Cropped ComboBox" width="236" height="123" class="size-medium wp-image-89" /></a></p>
<p>
This is annoying because users cannot read properly the information. To solve that problem, all we have to do is derive the ComboBox class and override the DropDown event as follows:
</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">ComboBoxEx</span> <span class="p">:</span> <span class="n">ComboBox</span>
<span class="p">{</span>
	<span class="k">public</span> <span class="nf">ComboBoxEx</span><span class="p">()</span>
		<span class="p">:</span> <span class="k">base</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="n">DropDown</span> <span class="p">+=</span> <span class="k">new</span> <span class="nf">EventHandler</span><span class="p">(</span><span class="n">event_DropDown</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">void</span> <span class="nf">event_DropDown</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">try</span>
		<span class="p">{</span>
			<span class="n">ComboBox</span> <span class="n">comboBox</span> <span class="p">=</span> <span class="p">(</span><span class="n">ComboBox</span><span class="p">)</span><span class="n">sender</span><span class="p">;</span> <span class="c1">// Catch the combo firing this event</span>
			<span class="kt">int</span> <span class="n">width</span> <span class="p">=</span> <span class="n">comboBox</span><span class="p">.</span><span class="n">Width</span><span class="p">;</span> <span class="c1">// Current width for ComboBox</span>
			<span class="n">Graphics</span> <span class="n">g</span> <span class="p">=</span> <span class="n">comboBox</span><span class="p">.</span><span class="nf">CreateGraphics</span><span class="p">();</span> <span class="c1">// Get graphics for ComboBox</span>
			<span class="n">Font</span> <span class="n">font</span> <span class="p">=</span> <span class="n">comboBox</span><span class="p">.</span><span class="n">Font</span><span class="p">;</span> <span class="c1">// Doesn't change original font</span>

			<span class="c1">//checks if a scrollbar will be displayed.</span>
			<span class="kt">int</span> <span class="n">vertScrollBarWidth</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">comboBox</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="n">comboBox</span><span class="p">.</span><span class="n">MaxDropDownItems</span><span class="p">)</span>
			<span class="p">}</span>
				<span class="c1">//If yes, then get its width to adjust the size of the drop down list.</span>
				<span class="n">vertScrollBarWidth</span> <span class="p">=</span> <span class="n">SystemInformation</span><span class="p">.</span><span class="n">VerticalScrollBarWidth</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">else</span>
			<span class="p">{</span>
				<span class="c1">//Otherwise set to 0</span>
				<span class="n">vertScrollBarWidth</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="c1">//Loop through list items and check size of each items.</span>
			<span class="c1">//set the width of the drop down list to the width of the largest item.</span>
			<span class="kt">int</span> <span class="n">newWidth</span><span class="p">;</span>
			<span class="k">foreach</span> <span class="p">(</span><span class="kt">string</span> <span class="n">s</span> <span class="k">in</span> <span class="n">comboBox</span><span class="p">.</span><span class="n">Items</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="n">newWidth</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">g</span><span class="p">.</span><span class="nf">MeasureString</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="nf">Trim</span><span class="p">(),</span> <span class="n">font</span><span class="p">).</span><span class="n">Width</span> <span class="p">+</span> <span class="n">vertScrollBarWidth</span><span class="p">;</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">width</span> <span class="p">&lt;</span> <span class="n">newWidth</span><span class="p">)</span>
						<span class="n">width</span> <span class="p">=</span> <span class="n">newWidth</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="c1">// Finally, adjust the new width</span>
			<span class="n">comboBox</span><span class="p">.</span><span class="n">DropDownWidth</span> <span class="p">=</span> <span class="n">width</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">catch</span> <span class="p">{</span>  <span class="p">}</span>
	<span class="p">}</span>   
<span class="p">}</span></code></pre></figure>

<p>
The following picture shows the results of using the above control instead of the default one:
</p>
<p><a href="/wp-content/uploads/2008/11/image003.png"><img src="/wp-content/uploads/2008/11/image003.png" alt="Non Cropped ComboBox" title="Non Cropped ComboBox" width="236" height="123" class="size-medium wp-image-90" /></a></p>

        </div></li></ul>
  <div class="pagination">
    
      <a class="previous" href="/posts/29/">&laquo; Older</a>
    

    
      <a class="next" href="/posts/27/">Newer &raquo;</a>
    
  </div>

</div>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

Powered by <a href="https://jekyllrb.com">Jekyll</a>. Theme based on <a href="https://github.com/yous/whiteglass">whiteglass</a>
<br>
Subscribe via <a href="https://thinkingeek.com/feed.xml">RSS</a>

    </p>

  </div>

</footer>


  </body>

</html>
